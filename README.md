# Algorithm Description

Алгоритм обрабатывает все матрицы как квадратные матрицы. В ходе исследований я обнаружил, что квадратные матрицы умножаются в короткие сроки. Например, умножение матрицы 1024x1024 на 1024x1024 занимает в 4 раза меньше времени, чем матрица 1024x1024 на 1024x1023, поэтому я преобразовал матрицы в квадратные матрицы, выровняв их размерность и заполнив пустые места нулями в соответствии с размером блока.

В ядре из-за использования общей памяти и ее ограничений по размерам я нашел решение из сети [1] под названием «tiling». Путем деления матриц на квадратные плитки алгоритм находит одну часть результирующего элемента, а затем рассматривает другие фрагменты и их результат, находит один элемент результирующей матрицы. При использовании решения для листов и разделяемой памяти, есть две важные вещи: объединенный доступ к памяти и конфликт банков. Чтобы предотвратить несвязанный доступ, плитки вывозятся из глобальной памяти построчно по размеру блока. При достижении элементов общей памяти матрицы соответствуют различным банкам, что видно из кода, поэтому таким образом предотвращается конфликт банков.

Другим важным моментом использования разделяемой памяти является синхронизация потоков. `__syncthreads ()` используется для заполнения общей памяти перед началом расчета. Если фаза расчета начинается до заполнения разделяемой памяти, потоки достигнут пустых мест.

## Compilation & Execution

```bash
nvcc mult.cu  -o mult

./mult
Enter m n n k :
1024 1024 1024 1024
GPU time= 1.987008 ms
CPU time= 4085.987000 ms
Results are equal!

```

## Block Size

При рассмотрении размера блока важно проверить характеристики платы GPU. Он поддерживает 32 банка при доступе к общей памяти, поэтому я использовал 16 и 32 в качестве размеров блоков. Различные размеры также пробуются для сравнения производительности. Размер сетки напрямую рассчитывается в соответствии с размерами матрицы.

## Test Results

Block Size of Tile | Matrix Dimension | GPU time in ms | CPU time in ms
--- | --- | :---:|:---:
8x8   | 16x16 & 16x16         |0.133    |0.0100
8x8   | 512x512 & 512x512     |0.295    |489.160
8x8   | 1024x1024 & 1024x1024 |2.299    |3896.926
16x16 | 16x16 & 16x16         |0.123    |0.0100
16x16 | 512x512 & 512x512     | 0.256 |465.544
16x16 | 1024x1024 & 1024x1024 | 1.966       |3885.956
32x32 | 16x16 & 16x16         | 0.143|0.0700
32x32 | 512x512 & 512x512     | 0.254       | 489.861
32x32 | 1024x1024 & 1024x1024 | 1.987|4085.987

## Environment
        Nvidia GeForce GTX850M
        Intel® Core™ i7-4700HQ CPU
        Cuda 10.0
